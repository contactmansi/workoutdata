<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="twitter:card" content="summary_large_image" /><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Facial Recognition using Convolutional Neural Network (CNN) | Workout Data</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="Facial Recognition using Convolutional Neural Network (CNN)" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="CNN is a neural network typically composed of two components, one component for extracting useful features of the data, and another for performing a ML task (like classification based on the featurized data)" />
<meta property="og:description" content="CNN is a neural network typically composed of two components, one component for extracting useful features of the data, and another for performing a ML task (like classification based on the featurized data)" />
<link rel="canonical" href="https://contactmansi.github.io/workoutdata/image-analytics/cnn/classification/fully%20connected/convolutional%20neural%20network/faces-dataset/2022/03/03/CNN-based-face-image-classifier.html" />
<meta property="og:url" content="https://contactmansi.github.io/workoutdata/image-analytics/cnn/classification/fully%20connected/convolutional%20neural%20network/faces-dataset/2022/03/03/CNN-based-face-image-classifier.html" />
<meta property="og:site_name" content="Workout Data" />
<meta property="og:image" content="https://contactmansi.github.io/workoutdata/images/facial_recognition.png" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2022-03-03T00:00:00-06:00" />
<script type="application/ld+json">
{"description":"CNN is a neural network typically composed of two components, one component for extracting useful features of the data, and another for performing a ML task (like classification based on the featurized data)","url":"https://contactmansi.github.io/workoutdata/image-analytics/cnn/classification/fully%20connected/convolutional%20neural%20network/faces-dataset/2022/03/03/CNN-based-face-image-classifier.html","@type":"BlogPosting","headline":"Facial Recognition using Convolutional Neural Network (CNN)","dateModified":"2022-03-03T00:00:00-06:00","datePublished":"2022-03-03T00:00:00-06:00","image":"https://contactmansi.github.io/workoutdata/images/facial_recognition.png","mainEntityOfPage":{"@type":"WebPage","@id":"https://contactmansi.github.io/workoutdata/image-analytics/cnn/classification/fully%20connected/convolutional%20neural%20network/faces-dataset/2022/03/03/CNN-based-face-image-classifier.html"},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/workoutdata/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://contactmansi.github.io/workoutdata/feed.xml" title="Workout Data" /><link rel="shortcut icon" type="image/x-icon" href="/workoutdata/images/favicon.ico"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Primer/15.2.0/primer.css" integrity="sha512-xTz2ys4coGAOz8vuV1NcQBkgVmKhsSEtjbqyMJbBHRplFuvKIUo6xhLHpAyPt9mfR6twHJgn9OgVLuqOvjeBhg==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.css" integrity="sha512-h7nl+xz8wgDlNM4NqKEM4F1NkIRS17M9+uJwIGwuo8vGqIl4BhuCKdxjWEINm+xyrUjNCnK5dCrhM0sj+wTIXw==" crossorigin="anonymous" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.js" integrity="sha512-/CMIhXiDA3m2c9kzRyd97MTb3MC6OVnx4TElQ7fkkoRghwDf6gi41gaT1PwF270W6+J60uTmwgeRpNpJdRV6sg==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/contrib/auto-render.min.js" integrity="sha512-Do7uJAaHZm5OLrIv/yN4w0iG1dbu01kzdMNnFfu/mAqgUk6Nniv2JYHcwH+cNwjqgLcqcuBBk+JRvprLVI8azg==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha512-0doc9hKxR3PYwso42RD1p5ySZpzzuDiOwMrdCEh2WdJZCjcmFKc/wEnL+z8fBQrnHoiNWbo+3fiGkOYXBdQp4A==" crossorigin="anonymous"></script>
    <script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement( document.body, {
        delimiters: [
            {left: "$$", right: "$$", display: true},
            {left: "[%", right: "%]", display: true},
            {left: "$", right: "$", display: false}
        ]}
        );
    });
    </script>


<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title") && (el.className != "emoji")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/workoutdata/">Workout Data</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/workoutdata/about/">About Me</a><a class="page-link" href="/workoutdata/search/">Search</a><a class="page-link" href="/workoutdata/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Facial Recognition using Convolutional Neural Network (CNN)</h1><p class="page-description">CNN is a neural network typically composed of two components, one component for extracting useful features of the data, and another for performing a ML task (like classification based on the featurized data)</p><p class="post-meta post-meta-title"><time class="dt-published" datetime="2022-03-03T00:00:00-06:00" itemprop="datePublished">
        Mar 3, 2022
      </time>
       â€¢ <span class="read-time" title="Estimated read time">
    
    
      11 min read
    
</span></p>

    
      <p class="category-tags"><i class="fas fa-tags category-tags-icon"></i></i> 
      
        <a class="category-tags-link" href="/workoutdata/categories/#image-analytics">image-analytics</a>
        &nbsp;
      
        <a class="category-tags-link" href="/workoutdata/categories/#cnn">cnn</a>
        &nbsp;
      
        <a class="category-tags-link" href="/workoutdata/categories/#classification">classification</a>
        &nbsp;
      
        <a class="category-tags-link" href="/workoutdata/categories/#fully connected">fully connected</a>
        &nbsp;
      
        <a class="category-tags-link" href="/workoutdata/categories/#convolutional neural network">convolutional neural network</a>
        &nbsp;
      
        <a class="category-tags-link" href="/workoutdata/categories/#faces-dataset">faces-dataset</a>
        
      
      </p>
    

    
      
        <div class="pb-5 d-flex flex-justify-center">
          <div class="px-2">

    <a href="https://github.com/contactmansi/workoutdata/tree/master/_notebooks/2022-03-03-CNN-based-face-image-classifier.ipynb" role="button" target="_blank">
<img class="notebook-badge-image" src="/workoutdata/assets/badges/github.svg" alt="View On GitHub">
    </a>
</div>

          <div class="px-2">
    <a href="https://mybinder.org/v2/gh/contactmansi/workoutdata/master?filepath=_notebooks%2F2022-03-03-CNN-based-face-image-classifier.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/workoutdata/assets/badges/binder.svg" alt="Open In Binder"/>
    </a>
</div>

          <div class="px-2">
    <a href="https://colab.research.google.com/github/contactmansi/workoutdata/blob/master/_notebooks/2022-03-03-CNN-based-face-image-classifier.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/workoutdata/assets/badges/colab.svg" alt="Open In Colab"/>
    </a>
</div>
        </div>
      </header>

  <div class="post-content e-content" itemprop="articleBody">
    <!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2022-03-03-CNN-based-face-image-classifier.ipynb
-->

<div class="container" id="notebook-container">
        
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">keras</span>
<span class="kn">from</span> <span class="nn">keras.models</span> <span class="kn">import</span> <span class="n">Sequential</span>
<span class="kn">from</span> <span class="nn">keras.layers</span> <span class="kn">import</span> <span class="n">Dense</span><span class="p">,</span> <span class="n">Input</span><span class="p">,</span> <span class="n">Conv2D</span><span class="p">,</span> <span class="n">Flatten</span><span class="p">,</span> <span class="n">MaxPooling2D</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">fetch_olivetti_faces</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">scipy</span> <span class="k">as</span> <span class="nn">sp</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="o">%</span><span class="k">matplotlib</span> inline

<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">random_seed</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">random_seed</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Working-with-Faces-Image-Data:-CNNs">Working with Faces Image Data: CNNs<a class="anchor-link" href="#Working-with-Faces-Image-Data:-CNNs"> </a></h2><p>Convolutional Neural Network (CNN) is  especially suited for feature extraction of image data. A CNN is a neural network typically composed of two components, one component for extracting useful features of the data, and another for performing a ML task (like classification based on the featurized data). We will also compare the performances and number of parameteres between Fully-Connected NNs (FCNNs) and CNNs.</p>
<p>In this article we also obtain and visualize how to obtain weight parameters for convolutional layer and outputs of convolution and MaxPooling Layer. Visualizing helps us enhance our interpretability of how the model is training on image dataset.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">image_shape</span> <span class="o">=</span> <span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="mi">64</span><span class="p">)</span>

<span class="c1"># load faces data</span>
<span class="n">faces_dataset</span> <span class="o">=</span> <span class="n">fetch_olivetti_faces</span><span class="p">(</span><span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">random_seed</span><span class="p">)</span>
<span class="n">faces</span> <span class="o">=</span> <span class="n">faces_dataset</span><span class="o">.</span><span class="n">data</span>
<span class="n">n_samples</span><span class="p">,</span> <span class="n">n_features</span> <span class="o">=</span> <span class="n">faces</span><span class="o">.</span><span class="n">shape</span>

<span class="c1"># function to visualize images</span>
<span class="k">def</span> <span class="nf">plot_face</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">img</span><span class="p">,</span> <span class="n">image_shape</span><span class="p">):</span>
    <span class="n">vmax</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">img</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="o">-</span><span class="n">img</span><span class="o">.</span><span class="n">min</span><span class="p">())</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">image_shape</span><span class="p">),</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">gray</span><span class="p">,</span>
              <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">,</span>
              <span class="n">vmin</span><span class="o">=-</span><span class="n">vmax</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ax</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">labels</span> <span class="o">=</span> <span class="n">faces_dataset</span><span class="o">.</span><span class="n">target</span>
<span class="c1"># take images from only two individuals</span>
<span class="n">X_flat</span> <span class="o">=</span> <span class="n">faces</span><span class="p">[(</span><span class="n">labels</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">labels</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)]</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">X_flat</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">20</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">Y</span> <span class="o">=</span> <span class="n">labels</span><span class="p">[(</span><span class="n">labels</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">labels</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">plot_face</span><span class="p">(</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">X</span><span class="p">[</span><span class="n">Y</span> <span class="o">==</span> <span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">image_shape</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">plot_face</span><span class="p">(</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">X</span><span class="p">[</span><span class="n">Y</span> <span class="o">==</span> <span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">image_shape</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
" />
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="I.-Classification-with-a-FNN">I. Classification with a FNN<a class="anchor-link" href="#I.-Classification-with-a-FNN"> </a></h2><p><strong>Task #1:</strong> Build a shallow FNN to classify the face images.</p>
<ol>
<li>Only one hidden layer and its hidden layer size is 4</li>
<li>Activation function is set to be relu</li>
</ol>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">input_dim</span> <span class="o">=</span> <span class="n">X_flat</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">H</span> <span class="o">=</span> <span class="n">input_dim</span>
<span class="n">hidden_size</span> <span class="o">=</span> <span class="mi">4</span>
<span class="c1"># create sequential multi-layer perceptron</span>
<span class="n">FCNN</span> <span class="o">=</span> <span class="n">Sequential</span><span class="p">()</span>
<span class="c1">#input layer</span>
<span class="n">FCNN</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Input</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">input_dim</span><span class="p">,</span> <span class="p">)))</span>
<span class="c1">#hidden layer</span>
<span class="n">FCNN</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="n">hidden_size</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;hidden_layer&#39;</span><span class="p">))</span>
<span class="c1">#binary classification, one output</span>
<span class="n">FCNN</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;sigmoid&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Classification_output_layer&#39;</span><span class="p">))</span>
<span class="c1"># configure the model</span>
<span class="n">FCNN</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">loss</span><span class="o">=</span><span class="s1">&#39;binary_crossentropy&#39;</span><span class="p">,</span><span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;acc&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Metal device set to: Apple M1 Pro
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>2022-03-04 15:39:40.436011: I tensorflow/core/common_runtime/pluggable_device/pluggable_device_factory.cc:305] Could not identify NUMA node of platform GPU ID 0, defaulting to 0. Your kernel may not have been built with NUMA support.
2022-03-04 15:39:40.436322: I tensorflow/core/common_runtime/pluggable_device/pluggable_device_factory.cc:271] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 0 MB memory) -&gt; physical PluggableDevice (device: 0, name: METAL, pci bus id: &lt;undefined&gt;)
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="What-is-the-number-of-parameters-in-the-above-FCNN-architecture?">What is the number of parameters in the above FCNN architecture?<a class="anchor-link" href="#What-is-the-number-of-parameters-in-the-above-FCNN-architecture?"> </a></h3><p>hint: print a summary of the model</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">FCNN</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Model: &#34;sequential&#34;
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 hidden_layer (Dense)        (None, 4)                 16388     
                                                                 
 Classification_output_layer  (None, 1)                5         
  (Dense)                                                        
                                                                 
=================================================================
Total params: 16,393
Trainable params: 16,393
Non-trainable params: 0
_________________________________________________________________
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">history</span> <span class="o">=</span> <span class="n">FCNN</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_flat</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>2022-03-04 15:39:40.587186: W tensorflow/core/platform/profile_utils/cpu_utils.cc:128] Failed to get CPU frequency: 0 Hz
2022-03-04 15:39:40.760222: I tensorflow/core/grappler/optimizers/custom_graph_optimizer_registry.cc:113] Plugin optimizer for device_type GPU is enabled.
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">score</span> <span class="o">=</span> <span class="n">FCNN</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">X_flat</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Train loss:&#39;</span><span class="p">,</span> <span class="n">score</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Train accuracy:&#39;</span><span class="p">,</span> <span class="n">score</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Train loss: 0.16936078667640686
Train accuracy: 1.0
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>2022-03-04 15:39:41.260553: I tensorflow/core/grappler/optimizers/custom_graph_optimizer_registry.cc:113] Plugin optimizer for device_type GPU is enabled.
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="II.-Classification-with-a-CNN">II. Classification with a CNN<a class="anchor-link" href="#II.-Classification-with-a-CNN"> </a></h2><p><strong>Task #2:</strong> Build a CNN with one convolutional layer, one maxpooling layer and one dense layer to classify the face images. What are some theoretical strengths and drawbacks of using CNN versus MLP for handling image data?</p>
<ol>
<li>Kernel Size, Stride Size and number of filters for Conv2D layer is specified as below. The activation function is relu</li>
<li>The pooling size is 4 by 4 for maxpooling Layer</li>
</ol>
<p>Other hyper-parameters in neural networks are set to be default.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">kernel_size</span> <span class="o">=</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="c1"># stride size</span>
<span class="n">stride_size</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="c1"># number of filters</span>
<span class="n">filters</span> <span class="o">=</span> <span class="mi">4</span>

<span class="n">cnn_model</span> <span class="o">=</span> <span class="n">Sequential</span><span class="p">()</span>
<span class="n">cnn_model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Input</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">1</span><span class="p">)))</span>
<span class="c1"># feature extraction layer 0: convolution</span>
<span class="n">cnn_model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Conv2D</span><span class="p">(</span><span class="n">filters</span><span class="p">,</span> <span class="n">kernel_size</span><span class="o">=</span><span class="n">kernel_size</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">,</span> <span class="n">strides</span><span class="o">=</span><span class="n">stride_size</span><span class="p">))</span>
<span class="c1"># feature extraction layer 1: max pooling</span>
<span class="n">cnn_model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">MaxPooling2D</span><span class="p">(</span><span class="n">pool_size</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">)))</span>
<span class="c1"># classification layer 2: flattening</span>
<span class="n">cnn_model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Flatten</span><span class="p">())</span>
<span class="c1"># classification layer 3: dense non-linear transformation</span>
<span class="n">cnn_model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Relu_Non_linear&#39;</span><span class="p">))</span>
<span class="c1"># classification layer 4: output label probability</span>
<span class="n">cnn_model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;sigmoid&#39;</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Output_label_probability&#39;</span><span class="p">))</span>
<span class="c1"># configure the model</span>
<span class="n">cnn_model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">loss</span><span class="o">=</span><span class="s1">&#39;binary_crossentropy&#39;</span><span class="p">,</span>
                 <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;accuracy&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="What-is-the-number-of-parameters-in-the-above-CNN-architecture.-And-compare-the-model-size-with-the-FCNN-model-size">What is the number of parameters in the above CNN architecture. And compare the model size with the FCNN model size<a class="anchor-link" href="#What-is-the-number-of-parameters-in-the-above-CNN-architecture.-And-compare-the-model-size-with-the-FCNN-model-size"> </a></h3>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cnn_model</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Model: &#34;sequential_1&#34;
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 conv2d (Conv2D)             (None, 57, 57, 4)         260       
                                                                 
 max_pooling2d (MaxPooling2D  (None, 14, 14, 4)        0         
 )                                                               
                                                                 
 flatten (Flatten)           (None, 784)               0         
                                                                 
 Relu_Non_linear (Dense)     (None, 4)                 3140      
                                                                 
 Output_label_probability (D  (None, 1)                5         
 ense)                                                           
                                                                 
=================================================================
Total params: 3,405
Trainable params: 3,405
Non-trainable params: 0
_________________________________________________________________
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Compare-the-CNN-model-size-with-the-FCNN-model-size">Compare the CNN model size with the FCNN model size<a class="anchor-link" href="#Compare-the-CNN-model-size-with-the-FCNN-model-size"> </a></h3><h4 id="FCNN-Model-total-parameters-=-16,393.">FCNN Model total parameters = 16,393.<a class="anchor-link" href="#FCNN-Model-total-parameters-=-16,393."> </a></h4><ul>
<li>Let's interpret this parameter size. For each face image with (64 x 64 x 1) pixels in grayscale equal to (64 x 64 x 1) weights are needed by every hidden layer along with 4 bias terms, 1 term for each layer, i.e. ((64 x 64 x 1) x 4) + 4 = 16,388 weight parameters are needed by the FCNN model hidden layers alone.</li>
</ul>
<h4 id="CNN-Model-total-parameters-=-3,405">CNN Model total parameters = 3,405<a class="anchor-link" href="#CNN-Model-total-parameters-=-3,405"> </a></h4><ul>
<li>Convolution Layer has 4 filter kernels with dimensions (8 x 8) each, that perform convolution operation with same size (8 x 8) sub grid of input image of dimensions(64 x 64 x 1) and move 1 stride in each iteration, first horizontally then vertically. This results into a smaller size output of dimension (57 x 57) each for 4 filters. Activation function 'relu' only gives outputs that are greater than 0. The (8 x 8) filter grid produces 64 weight paramters each for 4 filters that result into 256 weights and 4 bias terms(for 4 filter kernels) leading to 260 total weights in the convolution layer.</li>
<li>MaxPooling2D Layer has a pool_size of (4 x 4) which means that for every (4 x 4) sub-matrix moving with 1 stride on (57 x 57) image output of convoliton layer a maximum value from these 4 values will be resulting into output of this layer. This will reduce the convoluted image into (14 x 14) image output for each of the 4 filters and no weights as parameters.</li>
<li>These (14 x 14 x 4) are flattened into a single vector array with 784 values</li>
<li>This flattened array passes through 4 hidden layers producing (784 x 4 = 3136) weights and 1 bias terms for each of the 4 layers resulting into 3140 paramters.</li>
</ul>
<h5 id="We-can-conclude-that-the-number-of-model-parameters-is-significantly-reduced-due-to-convolution-layer-and-size-of-input-image-is-further-reduced-by-max_pooling-layer-according-to-pool_size.-In-this-way-the-hidden-layer-receives-only-784-values-for-creating-the-fully-connected-network-to-extract-features.-CNN-requires-very-less-parameters-as-compared-to-FCNN-model,-we-can-conclude-that-CNN-is-more-efficient-than-FCNN-for-image-feature-extraction-tasks.">We can conclude that the number of model parameters is significantly reduced due to convolution layer and size of input image is further reduced by max_pooling layer according to pool_size. In this way the hidden layer receives only 784 values for creating the fully connected network to extract features. CNN requires very less parameters as compared to FCNN model, we can conclude that CNN is more efficient than FCNN for image feature extraction tasks.<a class="anchor-link" href="#We-can-conclude-that-the-number-of-model-parameters-is-significantly-reduced-due-to-convolution-layer-and-size-of-input-image-is-further-reduced-by-max_pooling-layer-according-to-pool_size.-In-this-way-the-hidden-layer-receives-only-784-values-for-creating-the-fully-connected-network-to-extract-features.-CNN-requires-very-less-parameters-as-compared-to-FCNN-model,-we-can-conclude-that-CNN-is-more-efficient-than-FCNN-for-image-feature-extraction-tasks."> </a></h5>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">history</span> <span class="o">=</span> <span class="n">cnn_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>2022-03-04 15:39:41.565739: I tensorflow/core/grappler/optimizers/custom_graph_optimizer_registry.cc:113] Plugin optimizer for device_type GPU is enabled.
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># note: you should extract check both the loss function and your evaluation metric</span>
<span class="n">score</span> <span class="o">=</span> <span class="n">cnn_model</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Train loss:&#39;</span><span class="p">,</span> <span class="n">score</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Train accuracy:&#39;</span><span class="p">,</span> <span class="n">score</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Train loss: 0.6931488513946533
Train accuracy: 0.5
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>2022-03-04 15:39:42.517108: I tensorflow/core/grappler/optimizers/custom_graph_optimizer_registry.cc:113] Plugin optimizer for device_type GPU is enabled.
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>You should find the CNN model size is smaller than the FCNN model size while FCNN's training accuracy is much lower than CNN's training accuracy. <strong>Is it due to overfitting? If not, pls explain</strong></p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span> 
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>FCNN network with large number of parameters(16k) can face several problems such as overfitting, slower speed of training, capturing patterns globally and not locally, because in FCNN a single network is responsible for feature extractor of whole image. Due to this, FCNN fails at recognizing same/similar patterns at different locations as it might becomes location sensitive.</p>
<p>We must note that for image data analysis - <strong>local features matter and they are significantly very important</strong>.</p>
<p>CNN allows us to focus on capturing discriminative smaller sub-patterns that make model capable to differentiate between 2 and more faces. The CNN trained model is now capable to implement it's learnings on test data while performing classification operation. CNN allows to establish multiple networks of neurons for feature extraction wherein parameters such as filters, strides_size and pooling layers facilitate a smaller and optimum number of model parameters to capture local patterns for differentiation and lead to more efficiency, flexibility in learning and performance accuracy. Also, major advantage is that, in CNN small network neurons remain insensitive to location of patterns. Thus, when same/similar patterns appear in different regions of different images CNN  performs well in identifying these local patterns.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="III-What-Exactly-Does-a-CNN-Learn?">III What Exactly Does a CNN Learn?<a class="anchor-link" href="#III-What-Exactly-Does-a-CNN-Learn?"> </a></h2><p>A Multi-Layer Perceptron (MLP) trained for classification learns a non-linear transformation of the data so that the classes are linearly separable. Here, we could try to get an intuitive understanding of what is the transformation learned from each hidden layer in a CNN.</p>
<p><strong>Task #3:</strong> Let's visualize the weights connecting the input image to each kernel in the convolutional layer, these are called 'filters'. Explain how each filter is applied to the input image.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># we plot two sample images from the data set</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">plot_face</span><span class="p">(</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">X</span><span class="p">[</span><span class="n">Y</span> <span class="o">==</span> <span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">image_shape</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">plot_face</span><span class="p">(</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">X</span><span class="p">[</span><span class="n">Y</span> <span class="o">==</span> <span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">image_shape</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># using plot_face() function to visualize the four (8,8) filters cnn_model learned</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">plot_face</span><span class="p">(</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">cnn_model</span><span class="o">.</span><span class="n">layers</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_weights</span><span class="p">()[</span><span class="mi">0</span><span class="p">][:,</span> <span class="p">:,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">plot_face</span><span class="p">(</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">cnn_model</span><span class="o">.</span><span class="n">layers</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_weights</span><span class="p">()[</span><span class="mi">0</span><span class="p">][:,</span> <span class="p">:,</span> <span class="p">:,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">plot_face</span><span class="p">(</span><span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">cnn_model</span><span class="o">.</span><span class="n">layers</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_weights</span><span class="p">()[</span><span class="mi">0</span><span class="p">][:,</span> <span class="p">:,</span> <span class="p">:,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">plot_face</span><span class="p">(</span><span class="n">ax</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">cnn_model</span><span class="o">.</span><span class="n">layers</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_weights</span><span class="p">()[</span><span class="mi">0</span><span class="p">][:,</span> <span class="p">:,</span> <span class="p">:,</span> <span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
" />
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
" />
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Explain-how-each-filter-is-applied-to-the-input-image">Explain how each filter is applied to the input image<a class="anchor-link" href="#Explain-how-each-filter-is-applied-to-the-input-image"> </a></h3><h5 id="Each-(8-x-8)-kernel-performs-convolution-operation-with-smaller-(8-x-8)-sub-grids-of-input-face-image.-As-a-result-of-this-dot-product-operation,-4-feature-Maps-are-created-for-4-different-kernels.-To-understand-visually,-we-can-say-that-the-each-(8-x-8)-kernel-moves-first-horizontally-and-then-vertically-on-top-of-(8-x-8)-subgrids-of-each-(64-x-64-x-1)-face-image-with-1-step-stride-size-to-produce-a-convolved-image-of-(57-x-57).-The-4-kernels-with-different-weights-perform-the-same-dot-product-operation-on-input-face-image-to-produce-these-resultant-4-feature-Maps.">Each (8 x 8) kernel performs convolution operation with smaller (8 x 8) sub-grids of input face image. As a result of this dot product operation, 4 feature Maps are created for 4 different kernels. To understand visually, we can say that the each (8 x 8) kernel moves first horizontally and then vertically on top of (8 x 8) subgrids of each (64 x 64 x 1) face image with 1 step stride size to produce a convolved image of (57 x 57). The 4 kernels with different weights perform the same dot product operation on input face image to produce these resultant 4 feature Maps.<a class="anchor-link" href="#Each-(8-x-8)-kernel-performs-convolution-operation-with-smaller-(8-x-8)-sub-grids-of-input-face-image.-As-a-result-of-this-dot-product-operation,-4-feature-Maps-are-created-for-4-different-kernels.-To-understand-visually,-we-can-say-that-the-each-(8-x-8)-kernel-moves-first-horizontally-and-then-vertically-on-top-of-(8-x-8)-subgrids-of-each-(64-x-64-x-1)-face-image-with-1-step-stride-size-to-produce-a-convolved-image-of-(57-x-57).-The-4-kernels-with-different-weights-perform-the-same-dot-product-operation-on-input-face-image-to-produce-these-resultant-4-feature-Maps."> </a></h5>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Task #4:</strong> visualize the output of the convolutional layer and the pooling layer separately. Describe how each layer has transformed the data.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># using the backend.function in keras</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras</span> <span class="kn">import</span> <span class="n">backend</span>
<span class="n">face_0</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">Y</span> <span class="o">==</span> <span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="n">get_conv_layer_output</span> <span class="o">=</span> <span class="n">backend</span><span class="o">.</span><span class="n">function</span><span class="p">([</span><span class="n">cnn_model</span><span class="o">.</span><span class="n">layers</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">input</span><span class="p">],</span>
                                  <span class="p">[</span><span class="n">cnn_model</span><span class="o">.</span><span class="n">layers</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">output</span><span class="p">])</span>
<span class="n">layer_output</span> <span class="o">=</span> <span class="n">get_conv_layer_output</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">face_0</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">conv_output_img_shape</span> <span class="o">=</span> <span class="p">(</span><span class="mi">57</span><span class="p">,</span><span class="mi">57</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">plot_face</span><span class="p">(</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">layer_output</span><span class="p">[:,</span> <span class="p">:,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">conv_output_img_shape</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">plot_face</span><span class="p">(</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">layer_output</span><span class="p">[:,</span> <span class="p">:,</span> <span class="p">:,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">conv_output_img_shape</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">plot_face</span><span class="p">(</span><span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">layer_output</span><span class="p">[:,</span> <span class="p">:,</span> <span class="p">:,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">conv_output_img_shape</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">plot_face</span><span class="p">(</span><span class="n">ax</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">layer_output</span><span class="p">[:,</span> <span class="p">:,</span> <span class="p">:,</span> <span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">conv_output_img_shape</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAlAAAACbCAYAAACtUqUbAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjUuMSwgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy/YYfK9AAAACXBIWXMAAAsTAAALEwEAmpwYAAA6eklEQVR4nO2dW4xc13Wm/91NUrIuNMU7m6QkSpQhyILjBI4mhv3gkeGBLBtxHgIhcZDowYDykAESIEDszADxYJCHJA+J8zAZhIgMa4LMyJ5cYCGXGXtkOckkgW3JTjyRZckSI1mkSFE3iopkiuruPQ9df59Vf+19qqrrsLqb9X+AUF3nss8+h1tnrfr32mulnDOMMcYYY8zozK13B4wxxhhjNht2oIwxxhhjxsQOlDHGGGPMmNiBMsYYY4wZEztQxhhjjDFjYgfKGGOMMWZMJnKgUkp3pJQeTyk9mVL6VFedMrOFx5GZFI8h0wUeR2Yc0lrzQKWU5gE8AeBDAE4A+AaAn845f6e77plLHY8jMykeQ6YLPI7MuGyZ4NzbADyZcz4OACml+wF8DEB1sO3YsSPv378fKaWhjfOYYcfG/XQGR2m/xiRtjNrX9U5eGq8/ap+4Px6n5ywvL+P06dN49dVXx3l4Y42jlJIzv84GL+ac94x47NjvoiuuuCLv2LFj4k6ajcvZs2fxxhtvXLR3EQBs37497927d6TG9X3Jd+/c3Fzffn4vnaOMY6dqtm0Um6d2YhS7Mep1Sm2McsywfozaxjDabNokDtRBAM+G7ycA/Ju2E/bv34/PfvazfQME6L9R7uPnli1b+o7Rc+P35eXl4jG1gREfKM9ZXFwEAGzduhUAsLS0BACYn5/va4vXitt4jA4U3c9zY79K27SPkXh9vQc9h9t5L3E/+8T7JjxWr/fWW2+tbuPf3Hf+/Hn8/M//fLG/LYw9jsxM8MwYx449hnbs2LGWsWo2Eb//+78/7iljj6O9e/fit37rtwbsVulH6oULF/q+08Zs27YNQPMOvuKKK1bP5buV72O1g2ov2pwvtsHrar9oa+O5/GQf2Ybep26P7fEY3h9tjtqliNrKmj1iv0r2kPfJ69JesV/cHp+hOmRzc3Ot74lJHKiRSCndA+AeYMWBmpubG8uBUqdIt5fO1e/DvNf4t7ZR+8fm9tgXva46W/oZr1XzpEfx+GsOoj6rUn/1GelzUMcq/k+mDtS2bdsmUv9qxDFkzFqJ4+jtb3/7OvfGbFbiONqzZw/m5+dX3598F5Z+pOp3PYfv1vgjtWbT2IY6FvF9Xbsuj7n88sv79pdEAe2j9rX2vYTaUBUp2s7Vfum9xXv5wQ9+0NfeMBsanxnvg05l/Lct3tPQHtc5CeBw+H6ot62PnPOxnPN7cs7vsWRuCgwdR3EMTbVnZrMw9rso/so3psfY42j79u1T65zZeEyiQH0DwE0ppSNYGWQ/BeDjw06KClRJ9akpH/RW9biS/EfYvsqL+gnUp91qilDJWyfqlQ+7Ruk+9Fj+KtFfJPEY9eBVhi2pQ6qo6f3pr5Z4DZWeR/kFUWBN48iYgMeQ6YI1jaOc88CMSFRIau9yVYB0agkYVGn0Xa82NKpXpBbawjYvu+yyvu+l+1A7wevU+he30U7wHL0ez4n2kvt0GlBtalSKiPoQqo6pbWMbEZ7zgx/8oFWBWrMDlXNeTCn9ewD/G8A8gM/mnB9da3tmNvE4MpPiMWS6wOPIjMtEMVA5578E8JfjnLO8vDzgPUevVZWQcK2+76V5U50XrW1vU4DUo9d51JICpOeq8qX3UPpFUAtwqylEbavhVGnSexpFxaqpZaXAd/6SOnfu3JpWOqxlHBkT8RgyXTDuOEopYdu2bQOxpFEpefPNN/v28V3OY1RtiXZDbYsqTDqbE2dq1Kao3VX7FPtM+6Ptq53QONiSiqR9rdmYUlyx2j+dmeJ3xj3pM4hwuz5DKmQA8NprrwFYWWQCrKhlbXG9zkRujDHGGDMmdqCMMcYYY8bkoqcxiMRgO2AwIAwYzBVBalNZbfKa5pJomxYclkNJKaUC0HZrOTz4ndJu3FeTaPW51KYr43Vr6RRKubP0euyHXieeq3mltmzZclHSGBhjzEYkpYT5+fnW/IR8h77xxhsAgLe97W0ABgOkNU8U0ExN1RYkcVqqFDpRs0tqhzQfVDxXA7x5L7VFXSU0eFtzR+lUY9xWm+7k9Ut5ojSwXfumYTKlKT8+96uvvrr13qxAGWOMMcaMyVQVKKWkDOnSQwYo05usZQqP27R9okHUpSDyWkZZesLnz5+v3o+mVlDPuy3lQikrKtA8h5oSFc+pqXK15aulfRoMqMHzpaB9btu6dasVKGPMzKCzKqX3nyZtZQ4ynU15/fXXAZQXF1155ZV9+2gHqBqV7KEGp+tsgqYTiHZYM32rPdQ8arXFX7GP5F//9V/7vvOcOCOj9l5tqM7yxHNjUDjQKH/sM59pKY0Sn/O5c+cArPgfFyuRpjHGGGPMTLIuCpTG5JRioXQbveXaUsTYntatUxWltJxf54W1rVqSyhK6XFRVrFpis7itpvyUnhUZlgKi9EtDr1OrE9SWJLP068cYY2aBUgLKqLrw/ch3K9WNq666qm8/bVxUUKhKafJNflc1JSoxGh+lZclqccaxL5oCQZMnq9oT29BUB7weVZ5XX3217xoR3o/WsWP8mNbzK6XXqalUGk9d+vfjfb322mutds0KlDHGGGPMmExVgUopYcuWLQMxSNET1vTy9E75XSP2o6ev3rGuauAn22qrXK1z2aOs+lNlSVc56AqGUsHJUkr8Uv9KXvGwUiolhUrn1PUXRa0gcexjVMccA2WMmRWWl5dx/vz5VZvCd2FM7Kir7xgDpDE5pVhZ1tpj+2rDYvypUlNOeCzf+SXbpvFBqkTRtvJeuD/aDy2zorFQVKI0zje2o+fwmWnMMpW6iPZVk3CWbK2uci+VeYlYgTLGGGOMGZOpK1Bzc3NVLzpCD5BzvjrHS689eoiaX4keJ9tQrzZ6pDyG3rB63KRUTJjtasxTTZEqFUzm3/y1UsshpQoR0PxK4S8LfUb666SU9l5X3dXybZVySNXS7BtjzKXM3NwcrrjiitV3Hz/jam2WB7nmmmsANPaHn7Q9jImKq/Y0npfn0HZqPqhSCRmeo4pUmz0iWtJFy9LQlrCfMQZLV/lRPaINo61j//g9ovHEGi/GZxXtIp+92jLNqRXtYO16w2ZVrEAZY4wxxozJUAUqpfRZAB8FcCbnfGtv204AnwdwPYCnAdyVc35lWFs5Z+ScB1ajRc+XXqOusnvllZXmz5w503funj17Vo/RArz8fvXVVwMYjKMqzRtzmyowtaKK8W9VgDQPFD/Pnj070AbncPlJr1yLU9LT5q+W2C7n2OmBsw166SUVS5UueuV6T7VM7ZE2T73LcWRmE48h0wVdjqO5uTlcfvnlA6vluMIMaOzOrl27AAB79+5dPRdo3rFso7QqjLFGOkPBc9TWxW2azVtVJH6PscjcpivWqabxnmiHeA/Rpmr8MvvDNngNPqt4Ls9R9Uxjrki0hzyXMzO0i2rDSivbS6rdpHmgPgfgDtn2KQAP5pxvAvBg77sxbXwOHkdmMj4HjyEzOZ+Dx5HpgKEKVM75b1JK18vmjwH4QO/v+wB8FcAnR2gLb7755sB8ccxMSi90x44dABrv9NSpUwAaL3nfvn0A+ueLqZ68/PLLfe3T49W5XnqqQOO58xcEz+FKgVLsUw1VdagI6aqAGL+lKyLoFXPemL88SjmsuI/eM8/lPfCeqNZFj5rz8pr/iv8mbJNefKRUY6imQnU5jsxs4jFkuuBijCONEaXaBACHDx8GAFx//colaeMeffRRAM2MBO1RzPL94osvAmhs28LCQt93fj7//PMAGtUl/k0bSbugOaVoP+LMhK6w5nV0FoffdZYHaOyw2iHeL7+XYq+uvfbavj7R/t94440AmlxaTz75ZF//Yru0d3z+cbYqPo9o07VOIWe+aqw1BmpfzvlU7+/TAPatsR0z23gcmUnxGDJd4HFkxmbiIPK8ImdUJwlTSveklB5OKT1Mz9MYpW0cxTE05W6ZTcQ476LSih9jANs0MzprTWPwfErpQM75VErpAIAztQNzzscAHAOAm2++OXMaD2ikwyjhUb7kFB4lPE7l7dy5E0C5fAinozRIjsfwUwsUx2M13buiqQqAwZT1RBOkaRLQKB1yG++b0358HpRG+cx4HNDIjJpkjDKySqdcLgsMBhpSCtUAe043Rpl3lNI0QxhpHMUxlFKqR/SZWWRN76KFhQWPIxNZ0zg6evRoPnfu3MACpjgNx22nT58GMGgn9P0Zp8H4rtbSWnxP007QptEGxnb43qc94HXUPkX4nmf7WgZGUxDFtA2E02ycyqMNoY3dvXs3gMamx5CW6667ru86nMrkJ+HziFOmvC5t6vHjxwEAL7zwAoBmKo/PLPofnMLj/V511VWtdm2tCtQDAO7u/X03gC+usR0z23gcmUnxGDJd4HFkxmaUNAb/AyvBdbtTSicAfBrAbwD4QkrpEwCeAXDXKBdLKWHr1q0DgdIxQJkBX/QoNdUBz6WHH5UgeqMHDhwA0HicvE6bAqVB2lpUV9PNl0rI0Gvl0lL9ZaHJOqPKowkz1RPWJGQMzAOaXym6tFPL3WhiMWAw6Rjb1wKQpaWcmtIhJkktHNvZODKziceQ6YIux9Hi4iJefPHFAWUowvf/c889B6CxS/v37+87ju/8Q4cOrW7jIibOOFBNodJE+0RVh/YTaN7tTP3D9tmmlikpJZbmfWkRY7ULnAUppcjRlAi0dVTGuCDsxIkTq+dy3zvf+U4AwLve9S4AjZ1+6aWXAABHjhzp61+8b13EpUogn0Pss6aWGJZIc5RVeD9d2fXBYecaQzyOzKR4DJku8DgyXTH1Ui5xflfVHqDxbLn0kh4nPW56+IyJinOfzzzzDIDGe+RcKD1Pzn1ySWT0PDUlvhY61ALFqvZEaoWJNbV9qQ31ljWOq1Tcl78KuJSUChjvj8+By1rjfDWfMxUutstzeX3te9ynsVDGGDMrpJRW35dUYuI7VuN5+b7kMTfccAOARqH64AcbP442i+oM7SFVKr6X/+Vf/gVAv6rF9z5jjXh9TQpNSoks9djajARVppiSiOdqagDaKfaPNj32/eTJk33HUrWjveJzqc2+xL5QrVJ1sFS8mTM77HMp2XbEpVyMMcYYY8ZkqgoU0MRBAYMrC+Lf9M4Zwf/4448DaDxdeqYxQp5eI+dP6a3Ta2VbUQUjWg5Fy8GwX9xe8kx1n55Lr72UlJP3y/ujt6xxVPwVEVP261wvP3kO1bpS0V966fw1wHZVgdJfEfG+SIytMsaYS535+Xls3759YKVWXOnMBJqadJKzGVT/GcdDNQlo3tVMGMn3Mc+lavPUU08BaGKk4vViX4BBm1Iq06UlvGiXuJ3X5+yHqmtAYzPUDurqwKeffhpAM+sTr0sliioSr0u7RfUuxnNxVoq2inFhGgNFtam0oj4m+26bWbECZYwxxhgzJlNVoJaXl/vmSKl6xFV4qpo8++yzAJr8D5z71BxHQOOFavFCxgTRO9aVBdrHeK4WHGwrqqvlUFTxYf9KuTN4H1rwV38JaGHIeIzGS6nHT1Urxn7pXDf7Ru+cbWtbcZ8WSzbGmFmAChShihJVH9osvi9pyxgvpUWE/+7v/m71XL6rqcQwnolxvFownnHAQKNsUemhnT148CCAQVtXmkGo2TSdoWA/ohLHc6i4sdwM4XOjuhZnRrhykM+KcWSMBdOY5WjLNWchfQjeP5+VzhQBjdIWS9m0rcKzAmWMMcYYMyZTVaCWlpZw9uzZVQ+RKkdcSUdvkN4iPVoWF+RqPCpZMRaI27Swo2bvLq0a04yrPJYeqea/iJ62et9stxbzVMrcrUoPPepaAeR4ru7jp+bMKq1U0GfFXxy1IsqaOyT23QqUMWYW0ezecWaECpCqOLRxtD179+4F0KhLQBM/RdWEagrtAwsSMx9SVL50toL2ljZN3/ER2lL2UWdNdCZGZ2ziNtofKk58Nrw+bXspEzmfHZ8Dv/PziSee6GsDaOwRr8M+MtaKPgPvLfoftPu8/6WlJStQxhhjjDFdMvUYqDfeeGNg7jXGQNFbpIerq+14rsYGAY33rd4zFRnOiZZyGmluJo1X4rnsc5xzVaVJY5A083qbiqOxUHqfbDs+M7ZXWxXHvtPjj3O+qpbV1KTS/LhmOC/9kjHGmEsVzqrw3c64pvgu5go5vlupePB9TEWIq+9iJnLaGSojXI2m2bSpWjGeKp7DWnOMgWVOJX3HR3tIG8rr81ytEavxt1F5i3amdCxtGpUpPod4rPbnR3/0RwE0MdKPPfYYgCZmKvZV6+pyxSKvQ0UuPgdWMeG5Fy5cuCi18IwxxhhjZhY7UMYYY4wxYzL1RJo554HpqSh3chunjCgZ8pMSJaf2Ynp27tMpM00NUEITgWkbbWVLNDV/vNd4/VLiUKJJOPW+9bpxGlCn1yg/sj+c7lPpNN6fypS6tJXfSwlEdRrQGGNmgcXFxb4pPFJKr0NbxVQEGp7CNqJNY9A4p/VYXJdTa5zKo52IaWY0tEM/NdQl2gBNaE37GKcIgf5pt3hePFdtNvsVC/YC/VN+3MdCw7wO22JQ/S233AKgP/BepxvZPtukfeR9x+fN6U2GAw1LDm0FyhhjjDFmTIYqUCmlwwD+G4B9ADKAYznn300p7QTweQDXA3gawF0551dGumjPI9Q08EDjhfIYLaqrya+i508PV5dc6lLLtmX3mt5e+0WvNXqmWuhXl3iqqqUKXNynyhc9b/6y4C+P2HctTaOed60AZKnPbUnVFD2mLdjuYowjM1t4DJku6HIc5Zzx1ltvDbz7YrA1A71ZSox2T89hwk0GogON4sIEkrRxDLxmih4Sk3pq2gTaHR7DIGoqMlEBop3h9XkMbTVVJNqn0rtfbbWWTuEzotpTCmLnPrZFm8574bOkIhX7quXY1F7pwrDYHvt6+eWXT1zKZRHAL+ecbwHwYwB+IaV0C4BPAXgw53wTgAd7342p4XFkJsVjyHSBx5HphKEKVM75FIBTvb9fSyk9BuAggI8B+EDvsPsAfBXAJ4e1l1IaUEZKsUn0MHksVRZN/hXnXOk9akwOv6uaFdFYoNpyTS2pAgwu11TFR8vBxPlxbV+TbOrcuipxEU2KWUsAVrp/fWY6X15KG6H32RYD1fU4MrOHx5Dpgq7H0fLy8oC6EVULfYdT3VB7oLYOGFRxWNpEZzdK8cQa+0qoGqkSpDYPGFSWanHE7F+8FvuiMblqLzSJNdA8PypsbIv3pH2O900fge3VSrzps4vtsN3z5893V0w4pXQ9gB8G8DUA+3oDEQBOY0UOLZ1zT0rp4ZTSw6x9Z2abccdRHEPT66XZyEz6LtKpDzObTDqOYm1XM3uMvAovpXQVgD8B8Es553PR48s555RSUX7IOR8DcAwAbrzxxlzyUKPnqSvFVGlRb7qUOr5WMmWYuhP7RPTYUgFC7YsqTurZl1YdaAmXWiJLjZGKfaypR6U0+4r+olGlTZOgReL12tLe944ZexzFMVQbZ2Z26OJdtLCw4HE043Qxjq699toMtNspTYapJbc0/rQUT8S+MSZJ7Y+W74p94iozXTGnq9Sj8qXxyVrKTGckqPJEW6e2gLFXtaSc8bvaWy2ppspTtIca86V2XmeZYj95bvRJJi7lklLaipWB9kc55z/tbX4+pXSgt/8AgDO1840BPI7M5HgMmS7wODJdMMoqvATgXgCP5Zx/O+x6AMDdAH6j9/nFYW1xxQK92lL+IJ0nVfVI45nkV0PfNs3hpKpKnM/VOVVVwFTVaUP7rNH+pba07zxHvXRub1tRp23W9sc+qvKkz6oUc6Zz2TnnahxUl+PIzCZdjqG5uTlcccUVq/9/6a9zc+nS9btobm6uNcegFqjX7ZqDMOb403Jgmg+QNk7VJKCxN7Spugqd1y3ZBS2OrGXIajFfJZvKc3nMNddcA2BwBWFUwPj/I6/D1Ydqc3T2JZ6jZdE0pyIpzYpF1arN5o8yhfc+AD8L4P+llP6xt+0/YGWQfSGl9AkAzwC4a4S2zOzicWQmxWPIdIHHkemEUVbh/V8ANRfsg+NcLOeMxcXFVU+4FP2vK+nUw+R29cyBwXlZerGapbWU/6GmXun+tqzbtT7r6rhSDittV2OddH/81VDzyomu8IsetSpctTxYPKcURzXiKrzOxpGZTbocQ1u3bsXevXtXf1E/99xzE/bObBa6HEdcVa7vy1JRXSpQXIXHdypjgkor6dSWqRLFT+ZBiuoV80mxDcZi6WxDaXV4bVW42jS1i/H6am+1UgdXy5Vmk/isGPNVmyHh9WPfa7MqPEafYUT/Hefn5yePgTLGGGOMMQ1TrYWXc8bS0tKAJxjjD1RxKa2UA8pKSS2vhXrrJRVJ53B1zpfeu/Yz9l9XYtTya5RioDTWSOeP2+Z8a2qRrjYonavPu/aM2rKM1/phzEZlfn4e11xzjRUoMxEppT6VoqTU1/IQ8rvmBYzvUR7DcUr7RHVHbVtpFRzzMKlawzZKtrZWXUNXlnM724oKlPZZn4eeG/0ArZen91RaLUc007tep6aixfvT+KkatnjGGGOMMWNiB8oYY4wxZkymOoUHNKkMgMEkXcCgZKlTZ5T0SmVZ+HeUEYH6UvwolapUp7JmaRm/ovejCTPbivrW0iTodWtLMUt9V4myJFnqdTRBm55bSrevfTNmo5Nzxvnz51eDVI2ZBAZI014xMBwYDARX+9SWIkcXE2mIiU6dxfGsi5Z0O/taCjXhObwe+85zeD3aAJZYKSW21qk8tqWpemIag7awk7if/kApsbTaJX2+/F4K+I/XaVscZQXKGGOMMWZMpqpAzc3N9SlKuqwSGPSGNVhOU8qXAsGJJirTJGDR49b2yVVXXQWg+YXRlsZAk/Gp0qUqTltpFe2XeuTx3NoSU6WUbkC31bx0Pb507rAln8ZsFLigRdUAY8ZhaWkJr776auvsAmvA7ty5E0Bjh1S1KZVy4bEMBFdVidel4lWyh0wXwGM0GbMuNorn1MrMsA3WAqyVXivtK5V9AcpJmhW1nWyrTSViX5m4UxemlWZz2tL2RKxAGWOMMcaMyVQVqJRSnwJVSlqpChSPb0sGqWiKenqnTAdPrzW2QfWISc6YmEyXQJJSAk+2qyoWt7Mt/vKIyzvVk9b7a/uFU2OctPe1eeJam/HYONc8Tv+MWS+WlpZw9uxZnDnjcmdm7SwtLeH111/H/v37ATR2IiaNZELLQ4cOAcDqmKM90vdoaVm9FoTXBJO0KdG+8hzaMqpKL730EoBGGeM1YmkV9k3tH49lW7R9bCten+3xvniOxgqrmhavq0kvaadr5dri38NS8+jxsT22P0yhtgJljDHGGDMm6xIDVfI4CT1ajXXSOCZSKkuiySF5Pc4j04vl/G28rkIvWlWm2Hed09VfBZpKXu8t/l1b3aAxWm2xSERjsEpJMXWOd1jyzbYSMo5/MpsFxkAZ0wW0Obt37wYAvPrqq6v7XnzxRQCDK8o5/jQmqVTiS2OQ1JbRTkSoUtGm7Nmzp68/VJVo21jkF2jsDY/lzIyuqDt8+HDfNaN9YB+pTvEcPgdViEoxyXwmtVmlkqqkNkxtmVKyWyUbXcIKlDHGGGPMmAxVoFJKlwP4GwCX9Y7/45zzp1NKRwDcD2AXgEcA/GzOeaQlLfQaS+nf6UnTe6bXrApQaeUAvcVaLqOzZ8/ynvqOj2zfvh3AoAeq3mz0eLm6Qee09RcGKc3bsg1eTwsjE02DH6+nK/RUNeJzKXnc6tmrh1+iVuC5xMUYR2a26HIMLS4u4qWXXlr9NayFTs2lS5fjaH5+Hm9/+9tXVZabbroJAPDUU0+tHqMrxriym9+1qG4pzpTQdnBF3+nTpwE045c2CGhsGI+hbdN4qVIx4RdeeGH1/oDGVlOJevbZZ/vujXY6qmxsl33jbA6vr9eNs0BsV+0wt7flgyQ8RtW7Wom32E5JFSsxigL1JoDbc84/BODdAO5IKf0YgN8E8Ds556MAXgHwiRHaMrOLx5GZFI8h0wUeR6YThipQecUlY7DQ1t5/GcDtAD7e234fgP8E4L8OaatvpRY9wqhAaYFhfqfXGjO8Av0eunqYOqdMT5hebfSWqXipiqTztfTESwoQ29cMq9yu9xCvr3O89J6HxTdFahnI2/J9aE4MPVcVsLZfR210OY7MbHIxxtA73vEOAMC3v/3tDntqNjJdjqOtW7di3759OHXqFABgx44d1WP53t21axeAJr6Itk4L9QKNXdAs3rwO7cSJEycGrs9ttD8nT57sa4sxwDwnrjTX6/Fdf/DgQQCNikb1rBRXzPvQOC72R4v9lmKUaqvEa3YxbqtV3mhbKc5z2Ndhq8pHioFKKc2nlP4RwBkAXwbwFICzOWfOlZ0AcLBy7j0ppYdTSg9T5jSzyVrHURxDU+us2ZB09S6KS7bN7NHVOOKUlplNRlqFl3NeAvDulNIOAH8G4OZRL5BzPgbgGAAcPXo0Ly0tDXiVpUzkGsfDiH7m1CjlNCrllQIaxYkedmlek560xkfRE9c8HHG+VusGaR09tqUrKEorCDUDe0k10vvW2K+22krx+Ni+tluLEyut/qutblDWOo7iGEopOdHUDNPVu2hhYSED/TEjZnboahwdOXIkx9ghigRxVRxnHBiDe+DAAQCD7/aSYqIxObQLtIOMPWJup2j7uKqO6pDGAr388st99xX7zNkRqmX8wUHbxevwuqUZIl5Pc0hxu1YiKdlytb+l+nXxnmI7qnxp3bySuqQ19rqIgYodOwvgIQDvBbAjpcR/rUMATo7TlpldPI7MpHgMmS7wODKTMMoqvD0A3so5n00pvQ3Ah7ASbPcQgJ/EyqqFuwF8cVhbOWfknAc80Yh645wv5QoCjcYfJaeRrlJjZtboLetKALZF7123x77zXN2nCpD2L845a/v0jtUDrlWnLl1HFbmSN60evapmqki1xV610eU4MrPJxRhDjF0xs0OX42h5eRnnz59fncGgMrSwsLB6DFfkMT6IygvtBM/lezSu2ub7mLaKNoNtMRaJq/LilCKvwz7t27evr32tyBFVHc38rbaU143PQdvQmn+0caPUd9V+1GZTdMU70DwjzTOlsypqt4FyrHFbrO8oU3gHANyXUprHimL1hZzzn6eUvgPg/pTSrwP4FoB7R2jLzC4eR2ZSPIZMF3gcmU4YZRXetwH8cGH7cQC3XYxOmUsPjyMzKR5Dpgs8jkxXTLWUS84ZFy5cGCjMG+U3LeWiEqIm1Izn6nSTln2hZKopEuKxKv8xeE7TDLANoJFNNQCcbdRKzMTpRw10U7mxVABZ71unN3UarhTsrQHvpJYyPwaVt6XiN2YzcPz48fXugrkEoL1iyAnDRCJMK/Dud78bQP29XHrH0/7wXcv3NafyGNwdp6Q5ZcekmAxiv/HGGwE0dkrDZYDG7nGqTqf9OC3IkjV79+4F0ATIx/vVUjWaWLqUcJr2UEub1Uq6xGfIfwu9Ti0MpS0MiGFHNVzKxRhjjDFmTKauQL311lutigg931qJBd1eWr6oiTSpFvFcfm8r5kvorbJfpbQCmmxTA7L5qd5zDPgrFZKM25XSs9Pnqp62KmHxHPXOawH5kVGSmhmzGWgLZDWmxtzcHC677LJVRYbKExc9RWhDdFZF0wvEd62W9NKZCG2zlGuRfaES9f3vfx9Ak+aAiTSZTBpobNhzzz0HoFGr+El7yXO+9a1vAQCOHj262gaDx/mpMzI6Q1L6f0+PVdtaQm2Y2qnSDJCeS7Zt29aapscKlDHGGGPMmKyLAkX4N+dvgWa5Jr1mfq8ldizFEfFTiwXyWE3OBQyqReyb/ipoi/PhuTUFiL8e9FqlPpJa/FSk5nHXjislLBulVMww1nKOMRuB/fv3A2h+cRszCjlnLC8vryZkZUxQW4JWHkMbxzgmJq2MNo6zG7rkX+NuVdWKxzBNAuOZqFLRxvG9XeozFS5+Mo6KbVHFon06c+bM6rmMwaJt0XspJaUmanc1SbWmO4rwepoMU+1jSfErqVSOgTLGGGOM6ZCpKlDAimdXisUhqh5pFL7OCZdKmhBdFUdqChEwqDwRXUlQSjpWm3OtqVja37hNveS2eCON39BVcVqYuHTfw1Qr/rvEf7O2uWRjNhOHDx8GYAXKjMfy8jJef/31VfWISTPb1HgqUFRoqOpoqRG9TvxUO6Q2CGhij3gslSi1rSxqzHuIaEkVXo/nsq2SesX74LGarFptSux7qbxLRO1inBnS2DL2nXHTagfjdXlujLmyAmWMMcYY0yFTV6CAwdxDJTVHi/dqKvtSOZiaAqMKiXqipWM0t5KqRppjou0cVaBKpV5KalSklttJ24nH1vKLxONV0dJjVEUrefq152zMZqFtVY8xNRjXq4XiWWQXAA4ePAgAOHlypbQeFRmu2GO+JCozMSaIdq+m/OjquGhLdXW4xhOxDcZgxT6zD7w+///Q3FFUnko2QO0e+8Z+MRaL9jjaVLWlql7VbGs8VmdPamXgSsrXqDkNbfGMMcYYY8ZkXVbhqXcXPcBa0V6uKNDChG25I3isFi3W+dx4To1x1BWdW6X3roWJS+3r3K7GVZVWzY0bi1QqnljL7KrPtzS3X5p/N2YzwdiVQ4cOrW6jMmBMGznn1bgmxhmdPn16df/1118PoFGguFKN9omqlc66AI3iRNuhMcFq22IGdC3eq/G9VH7Yj1JVD16P11HFi/ZA42yBQVWX1+cxbKMUE6xKm/ZLt0f1qmbLR1klrufq81WsQBljjDHGjMnIClSvcvXDAE7mnD+aUjoC4H4AuwA8AuBnc84X2tpgzgx60/R8o6dKr1hXG1CB2rlzJ4AmD0XJQ6zVdWPb9G5L+R94Lr9rjToSPVVdOTdM1SlRW0lHRsmeWsvppPFNpfipWu07Pa60ImFU5amLMWTMxRhHVAze//73r26zAnXp0uUYiu/kUpWLmOcQaDKCa2042qdoW5h/ibFIvBbVG2YRL62S1ryDuvpdV5xFhUaVJbaveRm5n7ac/Y37eKxmMedzYQxWpFbHVeOaNK64dO6weKqI+gHDZnXGUaB+EcBj4ftvAvidnPNRAK8A+MQYbZnZxGPIdIHHkZkUjyEzMSM5UCmlQwA+AuAPet8TgNsB/HHvkPsA/MRF6J+5RPAYMl3gcWQmxWPIdMWoU3ifAfArAJgtaxeAszln6mYnABwc9aKUEilZcjoOaCQ6ynq7d+8G0EiHhEsho+yoU0mawIuFD7k9Bp5p0DalOw1WLyXwjMHoug8oS6SKJkqrFUDUQsmx/Vopl3FKrNSShrUVDG4rBhn4DDocQ2Zm+Qwu4jiKUxDmkuUz6HAMLS8vr9oJ2pZYlF6n8AiniGn/GGQej9eUOwwS1wSWpSBu2graTqYNUHtUSuvDPnBqjlOT+v5n8HwpwTThdTS0hjacxGk43g/b0wVZmm4gnluy0bEfNZte6v/8/Hyr/RyqQKWUPgrgTM75kWHHVs6/J6X0cErp4dJcp7n06XIMddw1s4nochzZUZpNJh1DvTZWxxF/lJvZZBQF6n0AfjyldCeAywFsB/C7AHaklLb0vPZDAE6WTs45HwNwDACuu+66PD8/P6BU0LsFGm+cA3Pv3r0ABgPAS149vUceS+idalHB6G2qZ8tj2DctXlhKKMlzNNmneuC6PaLB6+pFa3mWeExtyaeqWaXratC+KnKlBGO15JsFOhtDKaV6Xn1zqdPZOFpYWCiOIxZHNZcsE40hoH8cHT58OC8vL6+qPFzkxLQYQGNnqB5RtaECdeuttwJobB5VH6B577LMCtvndi2DEtMn8EeCBlrzva0pgaKt0TQFmmKBi7poj19++eW+a8V2adNZPJnHaMB9tC2qDvFYtZ2ldDu1VEC19AYlW87rlRJmR4YqUDnnX805H8o5Xw/gpwB8Jef8MwAeAvCTvcPuBvDFYW2Z2cRjyHSBx5GZFI8h0yWTJNL8JID7U0q/DuBbAO4d5aSU0sC8ZkSXXvJYnc/VJGHAYAoE7tPlipx7LZVP0VgkTQtfU3viNlVkVN1pU4L0lwXRY+N+VamGlXKJ6HLQ2rJRVe9KLC0ttRZeLLCmMWSM0Nk4iuN7z549AJpl5+aSZs32bOvWrat2iUkzo32gOsN9//RP/wSgKeJLJYiqT1SgGONE9YpqziuvvNL3SRsXp6ZrRXTV/pRKqvF+1B6pnWCfS+mEaMuprKktV/sc7bRuY1/ZBp8Rv0elSNMU1NIIaWLReB0yLEXPWA5UzvmrAL7a+/s4gNvGOd8YjyHTBR5HZlI8hsykTL2CZlQoSqvhNNmXppBnGnx65vFc/q1xQuotq7oCDCYxUw+4rZiv7tN5WV2hwOPirxSd01UVq1Q0Uc/VOd5aOZjSfHEtXqrNAx9x9Z0xm4a///u/X/37rrvuAgD84R/+4Xp1x2wCUkqr702qTfv371/d/73vfQ8A8L73vQ9Ao0CxeC/jbRYWFgD0J5bktlocK9+9mmgTaOyBzrhoYWBSWlhBm8o2aivcaNuiisX2tBAybTrvk9eIq/FVadIiwqqeRQVM7WFtJmac+KkaLuVijDHGGDMmU1egUkoDuYyYnwIADh5cSb9Bj/rs2bMAmiKfjP7XWCigWaFANUm9ds0/FRUb/s1fA6ra0DNVDxgYVKVq+SZKyhOprcxTVam0kqCWul695zZvuqY81YoKt13HmM1KXBF8+PDhdeyJ2SzknFdVFCpQ73jHO1b3f+1rXwPQzJoojLHjOX/913+9uo+r7zQml3FFfPdTTYq5lXQ2R+N7+f6mnSrNbtQUKG2D9xbzX1FR4rGaxkjjrOL1tX21vzqbE1EbymOoUmmscikGqjTTVMIKlDHGGGPMmExdgVpeXl71IktqChUmzYBKj5NeLT19rpQBBud6OQerhRD1E2g8Ty2WqN5xKRO4xifV4pU011RUz3Q1QW0FXylnhvaj5jW3FQSuFSAmo6hMVqLMpcSjjz4KoFk99fTTT69fZ8yGJaogbSrOM888AwD4kR/5EQDAN7/5TQBNTNSRI0f6jgeAU6dOAWhmV7RNKlG0JXF1thbvpc3Q2CQ9HmjsLhUltQeqRHFWpxTXy5yNmh+RilRpJR2vz3Z1JT230+aX7HHt+zizK8OqeFiBMsYYY4wZk3WJgaI3SS+TGUqBxjuml0olirFQXJXA42LWcXq69BrZPj1dHqtZVYHGG1V1SI/VrK5A46Wr8qRzrHpcyVvXOCldjUcvvbRykR7+KPmm9Lq1Onptc8Cqgi0uLo6bB8qYDcs//MM/AAA+9KEPAbACZcosLS0NxBtxhgQAbrjhBgDAI4+sVI+58847ATQKFHM5PfnkkwCaeF8A+M53vgNgcAX5lVdeCaCZMSkpNTqrovX6NMch2wTKNhIYjCeiHWrLi0i7rPFUjO/iyvpYXUTjsjReS21PSfkbFqPLe4iqndbciyssS1iBMsYYY4wZEztQxhhjjDFjsi5TeG1F/jTlgBbXVdmxlPxLy7zoVBrl0CjtqSTJcziFqP2JkmUtfYEm8tKA8Hj9tuBwoJEUSyVV2gLcS/dfSrs/bLqvdA6p9dmYzQynFpjOgO+GuFTbmAjfyywYDADvfOc7AQDf/e53ATRpexi6wu/PPvssAOC9733v6rmcVtNpLl5HF0hFtGQKbafaMI7n2Ge1w6Xk05FSeTSew/vj/z8seMzC3ex7/P+K7WkxY9pBLS1TSoGg/kUpbUE8Lt53rfyLYgXKGGOMMWZM1kWB0oDl6HlqgDm/0/OmN7tjxw4A/cm5VHliygN63lqgt6R8qZdeS0nQlv592GdJxaoFj+v2UjJOVbT0uwb4xV8RGmCn6qAGz5fUplGXfBqzGWHw7x133AEAeOCBB9azO2aDkVJafcfyfRltGoPEmSiTShSVKS5WYHFhqk0AcOONNwIA/vmf/xlAY58480K7WEo3oAmlOfPCd7iWSYt9rhW1V/ukBYJLJc40xYGmUyglrWTxZFWeqGLpIq9oe0rJriOahDNetzQT1LYwygqUMcYYY8yYjKRApZSeBvAagCUAiznn96SUdgL4PIDrATwN4K6c8yvD2so5D6gZMb6Gc59MqKmFD6lMMYFYLEBID1oLAdOb5Tm8fizbQOjh1mJ+Sp52TfFR9aY2BxvvUz18UisXU9qm6llNoWo7Ru9XrxX3jVrSpctxZGaT9RhDX/7ylwEAn/70pwFYgboU6Goc5ZyxuLg48B6N73gqSjfffDOAprQLv1NF4mwKS7sAwNGjRwEABw4cANAk1tSUNZo0M+7Twrs19SbaFI3brbVBNaeUmkfjtNT+8ZNxxjElkc7A1NQ0nTmKaFHhmm0t3XdU1rpSoP5tzvndOef39L5/CsCDOeebADzY+27MMDyOzKR4DJku8DgyEzFJDNTHAHyg9/d9AL4K4JPDTorFhEurwnT+MnqlQFNsmCsGGAsVUWVJvVXuLyWjZJ9qBRjbYoFqRYNVkdIVdaVtuuKnLcFlLRmmbi89b+2b/mrQlRqjFCQekzWNI2MCUxlDjz/+OADgIx/5CADgL/7iL7q+hFlfxh5HjH+qvXOBRs2gzWJizaeeegoAcOuttwIAvv71rwMAnnjiidVzd+/eDQDYt28fgGZmhnaCSlDp3ctztfCwqjhtMzKq8NAu8Lq14vOxfbWDaofa7oHqFFE1S+10vI5+Z19L52j75MKFC50oUBnAl1JKj6SU7ult25dzPtX7+zSAfaUTU0r3pJQeTik9rNWYzcyxpnEUx9C0Omo2LJ28i0rpT8xMYZtmJmZUBer9OeeTKaW9AL6cUvpu3JlzzimlopuWcz4G4BgAXHfddXl5eXnA04xeK3NCMBaKnjYVEJZ0YQ6JmDKfBRfp0XJwM99GVJyAssdNNN9SLaV97x6r9xP70zYXW1vlp6nzdVVERHNYDMsHFVHFSfNvleKcdN5/BAVqTeMojqHaODMzQyfvooWFhbHH0f333w8A+LVf+zUAwJe+9CUA5fgLs+HpZBxde+21GajHnwLNO/PEiRMAgHe9610AGqWJ52icE9CUcrntttsAAHv37gUAvPTSSwCasaer8YDGVsQSLXG7rgaP9lHHNO0xbabmYSrFDHMfz9XYp1guBegvQ6NqkSpeOgNUUqDUZmpB4lrexHjusLjekRSonPPJ3ucZAH8G4DYAz6eUDgBA7/NMvQVjPI7M5HgMmS7wODJdMFSBSildCWAu5/xa7+9/B+A/A3gAwN0AfqP3+cVRLphzHoi7idCDVrWI3iM9b3rV8TjOD2uuCC20yLnZ6DXXPM3airrS8bU4JY3raltJV/Ow9brRm661X1O1YtuqsNVySZXud9Rsrb2+dTqOzOyxUcbQQw89BAD4+Mc/DgC47777LublTMd0PY5Kcb0Rvjup6nCVHYsGcxaFq8Vpx4AmV9L3v/99AM1sCo/ljIzmSYrbdAZEZxU0FgoYnInQ2FxVqEo5lYiuQq89qzi7wj7y/mur/dpsEO+rVomjtIJPs7YvLi62xkCNMoW3D8Cf9TqxBcB/zzn/r5TSNwB8IaX0CQDPALhrhLbM7OJxZCbFY8h0gceR6YShDlTO+TiAHypsfwnAB8e9YEqp1aPTVV/0eBkbxblezhMfOXJk9Vx6q/Q06a1rPJPOr8Z9vG5N8SmtNtCM6rX70+1RCWpTtkZpK/ZD71M9/hj7VVMD9fsoalNb37seR2b22Chj6G//9m8BNLEst99+OwDgK1/5yrS6YCagy3GUc8by8vJA3E3pPcltrHnH1Xe0U7QfMWaJWcypSnEfbdfVV18NYFDlAgZjfoiuGNRM4bX7jNep5YWKbdRijLQNPrNoDzUmV+2uZlUv9V3/DVRx0qojsb2Yad2ZyI0xxhhjOsQOlDHGGGPMmEy9mDBQLz0S0bIstZTtXBoKANdddx2AJnEY22dCMaY1KE3hURrVVO61wPDSsslauRWd2tLl/6V9msagVp6l1I7KmnovsT9tge1xe2mqT89tkzqNudT4vd/7PQDAPfespBHi1B7g1AazQkoJc3NzA+/cUjiDLsih7aLdoj2ivQKacXTy5EkAzXQfp7B4DhNOcsov9oXHaBFdnlNauET7q9NcOnWn1yjdt4aQ1L7HFAy1RVS1ND6lFAjarrapzwMYTNS5vLzsKTxjjDHGmC6ZugKVUqqWHgEGg8e0aDADoBlMzuByADh9+jSAwRT29E6pMmkb8Xq1hF0aeNeWSFOD5zRxprYZn4WiKftLag//1iB29bxLiS71PjW5WVvpGitOZpbh+Gex4Z/7uZ9b3XfvvfeuS5/M9Mk5DwRER6VEFReOG6Yg4Lud5VqYeBIA9uzZAwB4/vnnAQwW1aX94+xKtCOaSJqqFWFb7E+8rsJzqdpoaoS2tD61Umal4HHCvmgqAqIzMqXged6fXkdtWsmOxWPbEkRbgTLGGGOMGZOpK1DR2yupG+ql8zvVFHqv9C6jisT5X3qMu3btAgCcO3eur00tEwM0pWGoTtWW9ZdioDQ+S5W1YfFMcV/NSyellPnaN03FwO2loo2qkmkMlpZ0KSlv2oYxs8Tx48cBAAsLC6vbPvzhDwMA/uqv/mpd+mSmB+OgaqhKonaAiTWZkoCzLUBjq/j+pd1jIk3atpJd4PU0sbQqUSTGEdVsls6EaPqGiBamV7unbcd+acwT47VinFS8Bp9L/Dtui7BtVdFKDCtPZgXKGGOMMWZM0jTjWFJKLwB4HcCLU7vo2tmNzdFPYGP19bqc856L1fgmG0PAxvq3GcZG6qvHUT8b6d+mjY3Uz4s6hoBNN4420r/NMDZSX6vjaKoOFACklB7OOb9nqhddA5uln8Dm6msXbKb7dV83LpvpfjdLXzdLP7tks9zzZuknsHn66ik8Y4wxxpgxsQNljDHGGDMm6+FAHVuHa66FzdJPYHP1tQs20/26rxuXzXS/m6Wvm6WfXbJZ7nmz9BPYJH2degyUMcYYY8xmx1N4xhhjjDFjMjUHKqV0R0rp8ZTSkymlT03ruqOQUjqcUnoopfSdlNKjKaVf7G3fmVL6ckrpe73Pa9a7rwCQUppPKX0rpfTnve9HUkpf6z3bz6eUtq13Hy8WG3UcbbYxBHgceRxNjsfQxhtDgMfRtJiKA5VSmgfwXwB8GMAtAH46pXTLNK49IosAfjnnfAuAHwPwC73+fQrAgznnmwA82Pu+EfhFAI+F778J4HdyzkcBvALgE+vSq4vMBh9Hm20MAR5HHkeT4zG08cYQ4HE0FaalQN0G4Mmc8/Gc8wUA9wP42JSuPZSc86mc8zd7f7+GlX/Ig1jp4329w+4D8BPr0sFASukQgI8A+IPe9wTgdgB/3DtkQ/TzIrFhx9FmGkOAxxE8jibGY2hjjiHA42haTMuBOgjg2fD9RG/bhiOldD2AHwbwNQD7cs6nertOA9i3Xv0KfAbArwBgMb5dAM7mnFmMaMM+2w7YFONoE4whwOPI42hyPgOPIbJh79Xj6OLhIPJASukqAH8C4JdyzufivryyXHFdlyymlD4K4EzO+ZH17Ieps9HHEOBxtBnY6OPIY2hz4HF0cdkypeucBHA4fD/U27ZhSCltxcpA+6Oc85/2Nj+fUjqQcz6VUjoA4Mz69RAA8D4AP55SuhPA5QC2A/hdADtSSlt6HvuGe7YdsqHH0SYZQ4DHkcfR5HgMbeAxBHgcTYNpKVDfAHBTL7J+G4CfAvDAlK49lN6c670AHss5/3bY9QCAu3t/3w3gi9PuWyTn/Ks550M55+ux8gy/knP+GQAPAfjJ3mHr3s+LyIYdR5tlDAEeR/A4mhiPoY07hgCPo6mRc57KfwDuBPAEgKcA/MdpXXfEvr0fK1LmtwH8Y++/O7EyF/sggO8B+D8Adq53X0OfPwDgz3t/3wDg6wCeBPA/AVy23v2btXG0GceQx5HHkcfQpTeGPI6m958zkRtjjDHGjImDyI0xxhhjxsQOlDHGGGPMmNiBMsYYY4wZEztQxhhjjDFjYgfKGGOMMWZM7EAZY4wxxoyJHShjjDHGmDGxA2WMMcYYMyb/H3a/Mu2EnFWtAAAAAElFTkSuQmCC
" />
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">get_pool_layer_output</span> <span class="o">=</span> <span class="n">backend</span><span class="o">.</span><span class="n">function</span><span class="p">([</span><span class="n">cnn_model</span><span class="o">.</span><span class="n">layers</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">input</span><span class="p">],</span>
                                  <span class="p">[</span><span class="n">cnn_model</span><span class="o">.</span><span class="n">layers</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">output</span><span class="p">])</span>
<span class="n">pool_output</span> <span class="o">=</span> <span class="n">get_pool_layer_output</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">face_0</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span> 
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">maxp_output_img_shape</span> <span class="o">=</span> <span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">14</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">plot_face</span><span class="p">(</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">pool_output</span><span class="p">[:,</span> <span class="p">:,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">maxp_output_img_shape</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">plot_face</span><span class="p">(</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">pool_output</span><span class="p">[:,</span> <span class="p">:,</span> <span class="p">:,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">maxp_output_img_shape</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">plot_face</span><span class="p">(</span><span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">pool_output</span><span class="p">[:,</span> <span class="p">:,</span> <span class="p">:,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">maxp_output_img_shape</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">plot_face</span><span class="p">(</span><span class="n">ax</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">pool_output</span><span class="p">[:,</span> <span class="p">:,</span> <span class="p">:,</span> <span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">maxp_output_img_shape</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
" />
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Describe-how-each-layer-has-transformed-the-data.">Describe how each layer has transformed the data.<a class="anchor-link" href="#Describe-how-each-layer-has-transformed-the-data."> </a></h3><ul>
<li>In Convolution Layer has 4 filter kernels with dimensions (8 x 8) each, that perform convolution operation with same size (8 x 8) sub grid of input image of dimensions(64 x 64 x 1) and move 1 stride in each iteration, first horizontally then vertically. Sum of dot products of corresponding elements is the output of this layer. This results into a smaller size output of dimension (57 x 57) each for 4 filters which has been visualized as the output of the convolution layer. The non-linear activation function 'relu' gives outputs that are greater than 0.</li>
<li>MaxPooling2D Layer has a pool_size of (4 x 4) which means that for every (4 x 4) sub-matrix moving with 1 stride on (57 x 57) image output of convoliton layer a maximum value from these 4 elements will be resulting into output of this layer. This will reduce the convoluted image from (57 x 57) into (14 x 14) image output for each of the 4 filter kernels.</li>
<li>These (14 x 14 x 4) are flattened into a single vector array with 784 values which passes through 4 hidden layers that are able to learn features and representations through a connected neural network. The classifier can then recognize these sub-patterns in more faces images dataset.</li>
</ul>
<h2 id="Recommended:">Recommended:<a class="anchor-link" href="#Recommended:"> </a></h2><ul>
<li>To visually and theoretically understand working of CNN would recommend to read <a href="https://medium.datadriveninvestor.com/convolution-neural-networks-vs-fully-connected-neural-networks-8171a6e86f15">Convolution Neural Networks vs Fully Connected Neural Networks</a></li>
</ul>

</div>
</div>
</div>
</div>



  </div><!-- from https://github.com/utterance/utterances -->
<script src="https://utteranc.es/client.js"
        repo="contactmansi/workoutdata"
        issue-term="title"
        label="blogpost-comment"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script><a class="u-url" href="/workoutdata/image-analytics/cnn/classification/fully%20connected/convolutional%20neural%20network/faces-dataset/2022/03/03/CNN-based-face-image-classifier.html" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/workoutdata/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/workoutdata/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/workoutdata/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>An easy to use blogging platform with support for Jupyter Notebooks.</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/contactmansi" target="_blank" title="contactmansi"><svg class="svg-icon grey"><use xlink:href="/workoutdata/assets/minima-social-icons.svg#github"></use></svg></a></li><li><a rel="me" href="https://www.linkedin.com/in/mansiagarwal2911" target="_blank" title="mansiagarwal2911"><svg class="svg-icon grey"><use xlink:href="/workoutdata/assets/minima-social-icons.svg#linkedin"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>
